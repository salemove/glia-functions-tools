<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: cli/base-command.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: cli/base-command.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Base Command Class
 * 
 * This module provides a base command class for standardizing the Glia Functions CLI commands.
 * It handles common patterns for:
 * - CLI argument parsing using Commander.js
 * - Error handling
 * - API client creation
 * - Consistent output formatting
 * 
 * Commands should extend this base class to ensure consistent behavior across the CLI.
 */

import { Command } from 'commander';
import { getApiConfig } from '../lib/config.js';
import GliaApiClient from '../lib/api.js';
import { handleError } from './error-handler.js';
import chalk from 'chalk';

export class BaseCommand {
  /**
   * Initialize the command
   * 
   * @param {string} name - Command name
   * @param {string} description - Command description
   */
  constructor(name, description) {
    this.name = name;
    this.description = description;
    this.command = new Command(name).description(description);
  }

  /**
   * Add an option to the command
   * 
   * @param {string} flags - Option flags (e.g., '-n, --name &lt;name>')
   * @param {string} description - Option description
   * @param {*} [defaultValue] - Default value for the option
   * @returns {BaseCommand} The command instance for chaining
   */
  option(flags, description, defaultValue) {
    this.command.option(flags, description, defaultValue);
    return this;
  }

  /**
   * Add a required option to the command
   * 
   * @param {string} flags - Option flags (e.g., '--name &lt;name>')
   * @param {string} description - Option description
   * @param {*} [defaultValue] - Default value for the option
   * @returns {BaseCommand} The command instance for chaining
   */
  requiredOption(flags, description, defaultValue) {
    this.command.requiredOption(flags, description, defaultValue);
    return this;
  }

  /**
   * Create an API client with the current configuration
   * 
   * @returns {Promise&lt;GliaApiClient>} Configured API client
   */
  async createApiClient() {
    const apiConfig = await getApiConfig();
    return new GliaApiClient(apiConfig);
  }

  /**
   * Format output as JSON
   * 
   * @param {Object} data - Data to format
   * @returns {string} Formatted JSON string
   */
  formatJson(data) {
    return JSON.stringify(data, null, 2);
  }

  /**
   * Format output as a table
   * 
   * @param {Array&lt;Object>} data - Array of objects to display
   * @param {Array&lt;string>} [columns] - Columns to include
   * @returns {string} Formatted table string
   */
  formatTable(data, columns) {
    if (!data || data.length === 0) {
      return 'No data available';
    }
    
    // If columns not specified, use all keys from first item
    const keys = columns || Object.keys(data[0]);
    
    // Get maximum width for each column
    const widths = {};
    keys.forEach(key => {
      widths[key] = key.length;
      data.forEach(item => {
        const value = String(item[key] || '');
        if (value.length > widths[key]) {
          widths[key] = value.length;
        }
      });
    });
    
    // Build header
    let table = keys.map(key => key.padEnd(widths[key])).join(' | ');
    
    // Add separator
    table += '\n' + keys.map(key => '-'.repeat(widths[key])).join('-+-');
    
    // Add rows
    data.forEach(item => {
      table += '\n' + keys.map(key => {
        const value = String(item[key] || '');
        return value.padEnd(widths[key]);
      }).join(' | ');
    });
    
    return table;
  }

  /**
   * Print success message
   * 
   * @param {string} message - Success message
   */
  success(message) {
    console.log(chalk.green(`✓ ${message}`));
  }

  /**
   * Print info message
   * 
   * @param {string} message - Info message
   */
  info(message) {
    console.log(chalk.blue(`ℹ ${message}`));
  }

  /**
   * Print warning message
   * 
   * @param {string} message - Warning message
   */
  warning(message) {
    console.log(chalk.yellow(`⚠ ${message}`));
  }

  /**
   * Print error message
   * 
   * @param {string} message - Error message
   */
  error(message) {
    console.error(chalk.red(`✗ ${message}`));
  }

  /**
   * Define the action to execute when the command is run
   * 
   * @param {Function} actionFn - Action function
   * @returns {BaseCommand} The command instance for chaining
   */
  action(actionFn) {
    this.command.action(async (...args) => {
      try {
        await actionFn(...args);
      } catch (err) {
        handleError(err);
        process.exit(1);
      }
    });
    return this;
  }

  /**
   * Parse command line arguments and execute the command
   * 
   * @param {Array&lt;string>} argv - Command line arguments
   */
  parse(argv) {
    this.command.parse(argv);
  }

  /**
   * Get the Commander.js command instance
   * 
   * @returns {Command} Commander.js command
   */
  getCommand() {
    return this.command;
  }
}

export default BaseCommand;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-api.html">api</a></li><li><a href="module-config.html">config</a></li></ul><h3>Classes</h3><ul><li><a href="ApiError.html">ApiError</a></li><li><a href="AuthenticationError.html">AuthenticationError</a></li><li><a href="BaseCommand_BaseCommand.html">BaseCommand</a></li><li><a href="CircuitBreaker.html">CircuitBreaker</a></li><li><a href="ConfigurationError.html">ConfigurationError</a></li><li><a href="FunctionError.html">FunctionError</a></li><li><a href="GliaError.html">GliaError</a></li><li><a href="NetworkDetector.html">NetworkDetector</a></li><li><a href="NetworkError.html">NetworkError</a></li><li><a href="OfflineManager.html">OfflineManager</a></li><li><a href="OperationQueue.html">OperationQueue</a></li><li><a href="PersistentCacheStorage.html">PersistentCacheStorage</a></li><li><a href="RateLimitError.html">RateLimitError</a></li><li><a href="ResponseCache.html">ResponseCache</a></li><li><a href="ValidationError.html">ValidationError</a></li><li><a href="module-api.html">api</a></li></ul><h3>Global</h3><ul><li><a href="global.html#CLIAuth">CLIAuth</a></li><li><a href="global.html#CLIBuildMenu">CLIBuildMenu</a></li><li><a href="global.html#CLICreateProfile">CLICreateProfile</a></li><li><a href="global.html#CLIDeleteProfile">CLIDeleteProfile</a></li><li><a href="global.html#CLIDeployFunction">CLIDeployFunction</a></li><li><a href="global.html#CLIDevFunction">CLIDevFunction</a></li><li><a href="global.html#CLIFunctionDetailsMenu">CLIFunctionDetailsMenu</a></li><li><a href="global.html#CLIFunctionInvoke">CLIFunctionInvoke</a></li><li><a href="global.html#CLIFunctionLogs">CLIFunctionLogs</a></li><li><a href="global.html#CLIFunctionVersion">CLIFunctionVersion</a></li><li><a href="global.html#CLIFunctionVersions">CLIFunctionVersions</a></li><li><a href="global.html#CLIInitProject">CLIInitProject</a></li><li><a href="global.html#CLIListFunctions">CLIListFunctions</a></li><li><a href="global.html#CLIListProfiles">CLIListProfiles</a></li><li><a href="global.html#CLIMainMenu">CLIMainMenu</a></li><li><a href="global.html#CLIManageEnvVars">CLIManageEnvVars</a></li><li><a href="global.html#CLINewFunction">CLINewFunction</a></li><li><a href="global.html#CLINewVersion">CLINewVersion</a></li><li><a href="global.html#CLIProfileMenu">CLIProfileMenu</a></li><li><a href="global.html#CLISetup">CLISetup</a></li><li><a href="global.html#CLISwitchProfile">CLISwitchProfile</a></li><li><a href="global.html#CLIUpdateEnvironment">CLIUpdateEnvironment</a></li><li><a href="global.html#CLIUpdateFunction">CLIUpdateFunction</a></li><li><a href="global.html#DEFAULT_CACHE_CONFIG">DEFAULT_CACHE_CONFIG</a></li><li><a href="global.html#DEFAULT_OFFLINE_CONFIG">DEFAULT_OFFLINE_CONFIG</a></li><li><a href="global.html#DEFAULT_RETRY_CONFIG">DEFAULT_RETRY_CONFIG</a></li><li><a href="global.html#calculateBackoffDelay">calculateBackoffDelay</a></li><li><a href="global.html#createAndDeployVersion">createAndDeployVersion</a></li><li><a href="global.html#createBearerToken">createBearerToken</a></li><li><a href="global.html#createFromTemplate">createFromTemplate</a></li><li><a href="global.html#createFunction">createFunction</a></li><li><a href="global.html#createProjectFromTemplate">createProjectFromTemplate</a></li><li><a href="global.html#dev">dev</a></li><li><a href="global.html#displayRequestDetails">displayRequestDetails</a></li><li><a href="global.html#displayTroubleshootingHints">displayTroubleshootingHints</a></li><li><a href="global.html#displayValidationDetails">displayValidationDetails</a></li><li><a href="global.html#fetchAllLogs">fetchAllLogs</a></li><li><a href="global.html#fetchGfLogs">fetchGfLogs</a></li><li><a href="global.html#fetchLogs">fetchLogs</a></li><li><a href="global.html#formatEnvVars">formatEnvVars</a></li><li><a href="global.html#formatErrorForDisplay">formatErrorForDisplay</a></li><li><a href="global.html#getAllFilesInDir">getAllFilesInDir</a></li><li><a href="global.html#getProjectTemplate">getProjectTemplate</a></li><li><a href="global.html#getTemplate">getTemplate</a></li><li><a href="global.html#getTemplateDefaultVars">getTemplateDefaultVars</a></li><li><a href="global.html#getTemplateEnvVars">getTemplateEnvVars</a></li><li><a href="global.html#handleError">handleError</a></li><li><a href="global.html#initCommand">initCommand</a></li><li><a href="global.html#interactiveEnvVars">interactiveEnvVars</a></li><li><a href="global.html#invokeFunction">invokeFunction</a></li><li><a href="global.html#isRetryable">isRetryable</a></li><li><a href="global.html#listEnvVars">listEnvVars</a></li><li><a href="global.html#listFunctions">listFunctions</a></li><li><a href="global.html#listProjectTemplates">listProjectTemplates</a></li><li><a href="global.html#listTemplates">listTemplates</a></li><li><a href="global.html#listTemplatesCommand">listTemplatesCommand</a></li><li><a href="global.html#main">main</a></li><li><a href="global.html#makeApiRequest">makeApiRequest</a></li><li><a href="global.html#onInvoke">onInvoke</a></li><li><a href="global.html#parseAndValidateJson">parseAndValidateJson</a></li><li><a href="global.html#parseVariables">parseVariables</a></li><li><a href="global.html#replaceVariables">replaceVariables</a></li><li><a href="global.html#routeCommand">routeCommand</a></li><li><a href="global.html#runCLI">runCLI</a></li><li><a href="global.html#showDebug">showDebug</a></li><li><a href="global.html#showError">showError</a></li><li><a href="global.html#showInfo">showInfo</a></li><li><a href="global.html#showSuccess">showSuccess</a></li><li><a href="global.html#showWarning">showWarning</a></li><li><a href="global.html#sleep">sleep</a></li><li><a href="global.html#updateEnvVars">updateEnvVars</a></li><li><a href="global.html#updateFunction">updateFunction</a></li><li><a href="global.html#validateApiConfiguration">validateApiConfiguration</a></li><li><a href="global.html#validateDateString">validateDateString</a></li><li><a href="global.html#validateEnvironmentVariables">validateEnvironmentVariables</a></li><li><a href="global.html#validateFilePath">validateFilePath</a></li><li><a href="global.html#validateFunctionId">validateFunctionId</a></li><li><a href="global.html#validateFunctionName">validateFunctionName</a></li><li><a href="global.html#validateInput">validateInput</a></li><li><a href="global.html#validateTemplateVariables">validateTemplateVariables</a></li><li><a href="global.html#withRetry">withRetry</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
